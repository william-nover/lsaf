<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Model_gallery extends CI_Model {    function __construct()    {        parent::__construct();    }            function getMenuGallery($module_id){                $data = array();                        $hasil =   $this->db->query("SELECT a.menu_id as menu_id "                                 . "FROM tbl_menu as a "                                 . "INNER JOIN tbl_module as b on a.module_id = b.module_id where a.menu_parent = 0 and a.menu_sub_parent= 0  and a.module_id = '".$module_id."' ");				$data = $hasil->row_array();                                               return $data['menu_id'];             }            function getModule($module_name){            $data = array();            $sql="select module_id , module_group_id from tbl_module where module_name='".$module_name."' ";         		 $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;                 }        function getModuleAll(){		  $query	    = "SELECT  a.module_id,  a.module_name "                                                    . "FROM tbl_module as a where a. module_active_status = 1 and a.module_type = 1 order by a.module_group_id ASC" ;             		$query		= $this->db->query($query)->result_array();		return $query;	}                                 function getListGallery($cond = null){		  $query	    = "SELECT  a.gallery_id, a.module_id, a.gallery_title,"                                    . " a.gallery_order, a.gallery_active_status,"                                    . " DATE_FORMAT( a.gallery_create_date, '%d-%m-%Y %H:%i:%s' ) as gallery_create_date, a.gallery_create_by, "                                    . " b.module_name "                                                                      . "FROM tbl_gallery as a "                                    . " inner join tbl_module as b on a.module_id=b.module_id  "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();		return $query;	}         		function getListGalleryAlias(){		 $query		= "SELECT gallery_id, gallery_title, gallery_image, gallery_desc,						DATE_FORMAT( gallery_create_date, '%d %M %Y' ) as gallery_create_date,						c.web_alias, c.web_ori						FROM tbl_gallery a						INNER JOIN tbl_alias c ON a.gallery_id = c.key_id 						WHERE a.gallery_active_status = 1 AND c.alias_category = 'gallery' AND c.alias_active_status = 1						ORDER BY gallery_id DESC";		$query		= $this->db->query($query)->result_array();		return $query;	}		function getGallery($id = '')	{		$where = '';		if($id != ''){			$where = "WHERE gallery_id = ".$id;		}		 $sql	= "SELECT a.gallery_id,a.gallery_title, a.module_id, a.gallery_active_status, "                                    . "DATE_FORMAT( a.gallery_create_date, '%d-%m-%Y %H:%i:%s' ) as gallery_create_date, a.gallery_create_by "                                                                      . "FROM tbl_gallery as a "                                    . " $where "                                    . " ORDER BY gallery_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;		}	function checkGallery($gallery_title){		$sql	= "SELECT gallery_title FROM tbl_gallery WHERE gallery_title = '".$gallery_title."'";		$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;	}	function activeGallery($id)	{		$sql	= "UPDATE tbl_gallery SET gallery_active_status = abs(gallery_active_status-1),  				   gallery_update_date = now(), 				   gallery_update_by = ".$_SESSION['admin_data']['user_id']."				   WHERE gallery_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}	function deleteGallery($id = '')	{		$sql	= "DELETE FROM tbl_gallery WHERE gallery_id = ".$id;			$query	= $this->db->query($sql);				$str = $this->db->last_query();				return $str;	}        function insertGallery($gallery_title,$module_id)	{		$sql	= "INSERT INTO tbl_gallery SET                             gallery_title='".$gallery_title."',                             module_id='".$module_id."',                             gallery_create_by = ".$_SESSION['admin_data']['user_id'].", gallery_create_date = now()";					$query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();		return $last_id;	}	function updateGallery($id,$gallery_title,$module_id)	{		 $sql	= "UPDATE tbl_gallery SET                             gallery_title='".$gallery_title."',                             module_id='".$module_id."',                             gallery_update_by = ".$_SESSION['admin_data']['user_id'].",                             gallery_update_date=now() WHERE gallery_id = ".$id;			$query	= $this->db->query($sql);		return $query;	}         function updateOrderGallery($id,$order)	{		$sql	= "UPDATE tbl_gallery SET 				   gallery_order= ".$order.",				   gallery_update_by = ".$_SESSION['admin_data']['user_id'].", gallery_update_date=now() WHERE gallery_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}         function getPageView(){         $data = array();         $sql="select * from tbl_page_view order by page_type asc";                  $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;              }           function GenerateGallery($cond = null){		 $query		= "SELECT a.gallery_id, a.page_type, a.gallery_title, a.gallery_short_desc,"                                    . " a.gallery_image, a.gallery_desc, a.gallery_order, a.gallery_active_status,a.gallery_highlight, a.gallery_alias,"                                    . " a.gallery_meta_description, a.gallery_meta_keywords, "                                    . "DATE_FORMAT( a.gallery_create_date, '%d-%m-%Y %H:%i:%s' ) as gallery_create_date, a.gallery_create_by, "                                    . " b.menu_id, b.menu_title, c.page_title "                                    . "FROM tbl_gallery as a "                                    . " inner join tbl_menu as b on a.menu_id = b.menu_id "                                    . " inner join tbl_page_view as c on a.page_type = c.page_type "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();				return $query;	}       function getListBanner($cond = null){		  $query	    = "SELECT  a.banner_gallery_id,  a.banner_gallery_title,"                                    . " a.banner_gallery_image, a.banner_gallery_order, a.banner_gallery_active_status,"                                    . "DATE_FORMAT( a.banner_gallery_create_date, '%d-%m-%Y %H:%i:%s' ) as banner_gallery_create_date, a.banner_gallery_create_by "                                                                      . "FROM tbl_banner_gallery as a "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();		return $query;	}  function getBanner($id = '')	{		$where = '';		if($id != ''){			$where = "WHERE banner_gallery_id = ".$id;		}		 $sql	= "SELECT a.banner_gallery_id,a.banner_gallery_title,a.banner_gallery_image, a.banner_gallery_active_status, "                                    . "DATE_FORMAT( a.banner_gallery_create_date, '%d-%m-%Y %H:%i:%s' ) as banner_gallery_create_date, a.banner_gallery_create_by "                                                                      . "FROM tbl_banner_gallery as a "                                    . " $where "                                    . " ORDER BY banner_gallery_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;		}	function checkBanner($banner_gallery_title){		$sql	= "SELECT banner_gallery_title FROM tbl_banner_gallery WHERE banner_gallery_title = '".$banner_gallery_title."'";		$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;	}	function activeBanner($id)	{		$sql	= "UPDATE tbl_banner_gallery SET banner_gallery_active_status = abs(banner_gallery_active_status-1),  				   banner_gallery_update_date = now(), 				   banner_gallery_update_by = ".$_SESSION['admin_data']['user_id']."				   WHERE banner_gallery_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}	function deleteBanner($id = '')	{		$sql	= "DELETE FROM tbl_banner_gallery WHERE banner_gallery_id = ".$id;			$query	= $this->db->query($sql);				$str = $this->db->last_query();				return $str;	}        function insertBanner($banner_gallery_title,$banner_gallery_image)	{		$sql	= "INSERT INTO tbl_banner_gallery SET                             banner_gallery_title='".$banner_gallery_title."',                                banner_gallery_image='".$banner_gallery_image."',                             banner_gallery_create_by = ".$_SESSION['admin_data']['user_id'].", banner_gallery_create_date = now()";					$query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();		return $last_id;	}	function updateBanner($id,$banner_gallery_title,$banner_gallery_image,$banner_gallery_status)	{		 $sql	= "UPDATE tbl_banner_gallery SET                             banner_gallery_title='".$banner_gallery_title."',                             banner_gallery_image='".$banner_gallery_image."',                             banner_gallery_active_status='".$banner_gallery_status."',                            banner_gallery_update_by = ".$_SESSION['admin_data']['user_id'].",                            banner_gallery_update_date=now() WHERE banner_gallery_id = ".$id;			$query	= $this->db->query($sql);		return $query;	}         function updateOrderBanner($id,$order)	{		$sql	= "UPDATE tbl_banner_gallery SET 				   banner_gallery_order= ".$order.",				   banner_gallery_update_by = ".$_SESSION['admin_data']['user_id'].", banner_gallery_update_date=now() WHERE banner_gallery_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}   }